# Requirements (v0.1)

## 개요

본 문서는 TradingView 지표 기반 종목 추천 서비스의 기능 요구사항(Functional Requirements, FR)과 비기능 요구사항(Non-Functional Requirements, NFR)을 정의합니다.

**목적**: 사용자가 기술적 지표를 활용하여 투자 아이디어를 발굴하고, 과거 성과를 검증할 수 있는 웹 기반 플랫폼 제공

**대상 사용자**:
- 개인 투자자 (초급~중급)
- 퀀트 트레이더 (백테스트 활용)
- 재무 애널리스트 (시장 스캔 도구)

---

## 기능 요구사항 (FR: Functional Requirements)

### FR-001: 지표 선택 UI 제공
- **설명**: 사용자가 웹 UI에서 기술적 지표를 선택하고 파라미터를 설정할 수 있어야 함
- **상세**:
  - 지표 목록: 최소 20개 이상 (RSI, MACD, Bollinger Bands, SMA/EMA, ATR, ADX, OBV, Stochastic 등)
  - 각 지표별 파라미터 입력 폼 (예: RSI 기간 14일, Bollinger Bands 표준편차 2.0)
  - 파라미터 툴팁 제공 (각 파라미터 설명 및 권장값)
  - Preset 기능: 인기 있는 설정 미리 제공 (예: "RSI Oversold (30 이하)")
- **우선순위**: High
- **의존성**: FR-005 (지표 카탈로그)
- **Acceptance Criteria**:
  - AC-001-1: 지표 목록에서 20개 이상 지표 표시
  - AC-001-2: 각 지표 선택 시 파라미터 입력 폼 동적으로 렌더링
  - AC-001-3: 툴팁에 파라미터 설명 표시
  - AC-001-4: Preset 버튼 클릭 시 파라미터 자동 입력

---

### FR-002: 지정일 종가 기준 스캔 API
- **설명**: 사용자가 지정한 날짜(기본: 전일 종가)를 기준으로 전체 또는 선택된 종목군에서 지표 조건을 충족하는 종목을 스캔
- **상세**:
  - 입력: 지표명, 파라미터, 종목군(예: KOSPI, KOSDAQ, S&P500), 기준 날짜, 결과 개수
  - 출력: 조건 충족 종목 리스트 (티커, 이름, 지표 값, 점수, 간단한 설명)
  - 정렬: 점수(Score) 내림차순 또는 지표 값 기준
  - 페이지네이션: 100개씩 반환, offset/limit 지원
- **우선순위**: High
- **의존성**: FR-004 (데이터 수집), FR-005 (지표 계산)
- **Acceptance Criteria**:
  - AC-002-1: `POST /api/v1/scan` 요청 시 200 OK 응답
  - AC-002-2: 캐시된 응답 Top100을 3초 이내 반환 (universe=1000 종목 기준)
  - AC-002-3: 지정 날짜의 데이터가 없을 경우 400 Bad Request 및 명확한 에러 메시지
  - AC-002-4: 결과에 티커, 이름, 지표 값, 점수, 설명 포함

---

### FR-003: 지표 결과 정렬·필터링 및 설명 제공
- **설명**: 스캔 결과를 사용자가 원하는 기준으로 정렬·필터링하고, 추천 이유를 확인 가능
- **상세**:
  - 정렬 기준: 점수, 지표 값, 거래량, 시가총액, 등락률
  - 필터링: 시가총액 범위, 섹터, 가격 범위, 거래량 최소값
  - 추천 이유: "RSI 29.5 (Oversold 구간, 반등 가능성)" 같은 한 줄 설명
- **우선순위**: High
- **의존성**: FR-002
- **Acceptance Criteria**:
  - AC-003-1: 정렬 옵션 변경 시 1초 이내 재정렬된 결과 표시
  - AC-003-2: 필터 적용 후 조건에 맞는 결과만 표시
  - AC-003-3: 각 종목에 추천 이유 텍스트 표시

---

### FR-004: 백테스트 집계 및 지표 성능 랭킹
- **설명**: 각 지표와 파라미터 조합에 대한 과거 성과를 백테스트하여 통계 제공
- **상세**:
  - 백테스트 기간: 1일(1d), 1주(1w), 1개월(1m), 1년(1y)
  - 메트릭: 승률, 평균 수익률, 샤프 비율, 최대 낙폭(MDD), CAGR
  - 지표 성능 랭킹: 기간별 상위 10개 지표 표시
  - 백테스트 설정: 수수료, 슬리피지, 포지션 사이징 옵션
- **우선순위**: Medium
- **의존성**: FR-002, FR-005
- **Acceptance Criteria**:
  - AC-004-1: `GET /api/v1/backtest` 요청 시 백테스트 결과 JSON 반환
  - AC-004-2: 메트릭 5개 이상 포함 (승률, 평균 수익률, 샤프, MDD, CAGR)
  - AC-004-3: 기간별 상위 10개 지표 랭킹 표시
  - AC-004-4: 백테스트 파라미터 변경 가능

---

### FR-005: 지표 카탈로그 및 메타데이터 제공
- **설명**: 지원하는 모든 지표의 목록, 설명, 파라미터, Preset을 API로 제공
- **상세**:
  - 각 지표별 정보: 이름, 설명, 카테고리(모멘텀, 트렌드, 변동성, 거래량), 파라미터 스키마
  - Preset 리스트: "RSI Oversold", "MACD Golden Cross", "Bollinger Squeeze" 등
  - Pine Script 호환성 표시
- **우선순위**: High
- **의존성**: 없음
- **Acceptance Criteria**:
  - AC-005-1: `GET /api/v1/indicators` 요청 시 지표 목록 JSON 반환
  - AC-005-2: 각 지표에 name, description, category, parameters 필드 포함
  - AC-005-3: Preset 최소 3개 이상 제공

---

### FR-006: 사용자 저장 필터 (향후 기능)
- **설명**: 사용자가 자주 사용하는 지표 조합과 파라미터를 저장하고 불러올 수 있음
- **상세**:
  - 필터 이름, 지표, 파라미터, 종목군 저장
  - 저장된 필터 목록 조회 및 삭제
  - 공유 기능 (URL 생성)
- **우선순위**: Low (MVP 이후)
- **의존성**: FR-001, FR-002
- **Acceptance Criteria**: TBD

---

### FR-007: 알림 기능 (향후 기능)
- **설명**: 특정 지표 조건 충족 시 사용자에게 이메일 또는 푸시 알림
- **상세**:
  - 알림 규칙 설정: 지표, 파라미터, 조건 (예: RSI < 30)
  - 알림 채널: 이메일, 웹 푸시, Slack
  - 알림 이력 조회
- **우선순위**: Low (v1.0 이후)
- **의존성**: FR-002, NFR-005 (실시간성)
- **Acceptance Criteria**: TBD

---

### FR-008: 종목 상세 정보 조회
- **설명**: 특정 종목의 OHLCV 데이터와 지표 값 시계열 조회
- **상세**:
  - 입력: 티커, 기간 (시작일~종료일)
  - 출력: OHLCV 데이터, 선택한 지표의 시계열 값
  - 차트 렌더링 지원 데이터 (JSON)
- **우선순위**: Medium
- **의존성**: FR-004
- **Acceptance Criteria**:
  - AC-008-1: `GET /api/v1/ticker/{symbol}` 요청 시 OHLCV 및 지표 값 반환
  - AC-008-2: 날짜 범위 쿼리 파라미터 지원 (start_date, end_date)
  - AC-008-3: 응답 시간 1초 이내 (1년치 데이터 기준)

---

## 비기능 요구사항 (NFR: Non-Functional Requirements)

### NFR-001: 응답 시간
- **설명**: API 응답 시간 목표
- **상세**:
  - 스캔 API (`POST /api/v1/scan`): 캐시된 경우 2초 이내, 캐시되지 않은 경우 5초 이내 (Top100, universe=1000)
  - 지표 목록 조회: 500ms 이내
  - 백테스트 조회: 3초 이내 (1년 데이터 기준)
  - 종목 상세 조회: 1초 이내
- **측정 방법**: P95 latency 기준
- **우선순위**: High

---

### NFR-002: 가용성 (Availability)
- **설명**: 서비스 가동률 목표
- **상세**:
  - 목표: 99.5% uptime (월간 downtime 3.6시간 이하)
  - 계획된 유지보수는 가용성 계산에서 제외
  - Health check 엔드포인트 제공 (`GET /health`)
- **우선순위**: High

---

### NFR-003: 데이터 정확도 및 신뢰성
- **설명**: 제공하는 데이터의 정확성과 출처 명시
- **상세**:
  - 데이터 소스 명시: yfinance (PoC), Polygon/Tiingo (Production)
  - 데이터 품질 체크: 누락 데이터, 이상치 탐지
  - 데이터 업데이트 시간: 장마감 후 30분 이내 (미국 시장 기준)
  - 조정 종가(adjusted close) 사용 원칙
- **우선순위**: High

---

### NFR-004: 동시 요청 처리량 (Throughput)
- **설명**: 서버가 처리할 수 있는 동시 요청 수
- **상세**:
  - 목표: 초당 100 requests (동시 사용자 500명 가정)
  - 부하 테스트 도구: Locust, k6
  - Auto-scaling: CPU 70% 이상 시 pod 추가
- **우선순위**: Medium

---

### NFR-005: 데이터 지연 시간 (Data Latency)
- **설명**: 실시간 데이터 반영 시간
- **상세**:
  - EOD 데이터: 장마감 후 30분 이내 반영
  - 지표 계산: 데이터 수집 후 10분 이내 완료
  - 백테스트 결과: 매일 자정 업데이트
- **우선순위**: Medium

---

### NFR-006: 확장성 (Scalability)
- **설명**: 사용자 증가 시 시스템 확장 가능성
- **상세**:
  - Horizontal scaling: 서버 인스턴스 증설 가능
  - Database sharding: 종목 수 증가 대비
  - Cache 계층: Redis를 통한 스캔 결과 캐싱 (TTL 1시간)
- **우선순위**: Medium

---

### NFR-007: 보안
- **설명**: 데이터 및 사용자 정보 보호
- **상세**:
  - HTTPS 필수
  - API 인증: OAuth2 + JWT
  - Rate limiting: IP당 분당 60 requests
  - SQL Injection, XSS 방어
  - 민감 정보 암호화 (AWS Secrets Manager 사용)
- **우선순위**: High

---

### NFR-008: 모니터링 및 로깅
- **설명**: 시스템 상태 추적 및 문제 진단
- **상세**:
  - 로그 레벨: DEBUG (dev), INFO (prod)
  - 구조화된 로그 (JSON format)
  - 메트릭: 응답 시간, 에러율, DB 쿼리 성능
  - 알럿: 에러율 5% 초과, 응답 시간 P95 > 10초, DB connection pool 고갈
  - 도구: Prometheus + Grafana, CloudWatch
- **우선순위**: High

---

### NFR-009: 호환성
- **설명**: 지원 플랫폼 및 브라우저
- **상세**:
  - 브라우저: Chrome, Firefox, Safari, Edge (최신 버전 및 최근 2개 메이저 버전)
  - 모바일: 반응형 웹 (Tablet, Mobile)
  - API 버전 관리: `/api/v1/`, `/api/v2/` 형태로 버전 명시
- **우선순위**: Medium

---

### NFR-010: 유지보수성
- **설명**: 코드 및 시스템 유지보수 용이성
- **상세**:
  - 코드 커버리지: Unit test 80% 이상
  - 문서화: API 문서 (OpenAPI), 코드 주석, README
  - CI/CD: 자동 배포 파이프라인
  - 롤백: 배포 실패 시 자동 롤백 (5분 이내)
- **우선순위**: Medium

---

## 데이터 요구사항 (DF: Data Requirements)

### DF-001: 지원 시장 및 종목 수
- **PoC**: 미국 주식 S&P500 (약 500종목)
- **MVP**: 미국 주식 전체 (약 5,000종목) + KOSPI/KOSDAQ (약 2,500종목)
- **Production**: 글로벌 주요 시장 (미국, 한국, 일본, 유럽)

### DF-002: 데이터 보관 기간
- **OHLCV Raw 데이터**: 10년
- **지표 계산 값**: 3년
- **백테스트 결과**: 1년 (재계산 가능)
- **사용자 활동 로그**: 6개월

### DF-003: 데이터 업데이트 주기
- **EOD 데이터**: 매일 장마감 후 30분
- **지표 계산**: 데이터 수집 후 즉시
- **백테스트**: 매일 자정 (배치 작업)

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 0.1  | 2025-11-21 | 초안 작성 | Product Team |

---

**다음 단계**: `spec/11-acceptance-criteria.md`에서 각 FR/NFR에 대한 수용 기준 및 테스트 방법 상세화
